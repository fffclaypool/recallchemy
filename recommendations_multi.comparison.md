# recallchemy backend comparison

- generated_at: 2026-02-14T15:20:39.375453+00:00
- dataset: /tmp/recallchemy_data/toy.npz
- metric: angular
- target_recall: 0.95

## comparison table

| backend | recall | p95_query_ms | mean_query_ms | build_time_s | pareto |
| --- | ---: | ---: | ---: | ---: | --- |
| faiss-ivf | 0.9992 | 0.0432 | 0.0333 | 0.0027 | yes |
| hnswlib | 0.9517 | 0.0233 | 0.0219 | 0.0243 | yes |
| annoy | 0.9500 | 0.0761 | 0.0510 | 0.0183 | no |

## pareto front (recall up, p95 down)

- faiss-ivf: recall=0.9992, p95=0.0432ms
- hnswlib: recall=0.9517, p95=0.0233ms

## recommendation rationale

- faiss-ivf: Selected lowest p95 latency among trials with recall >= 0.950
- hnswlib: Selected lowest p95 latency among trials with recall >= 0.950
- annoy: Selected lowest p95 latency among trials with recall >= 0.950


## analysis setup

- comparison_seeds: 5
- seeds: [100, 101, 102, 103, 104]

## 1. Anytime (best-so-far by trial)

### backend: annoy

| trial | optuna best recall (mean±std) | optuna best p95_ms (mean±std) | random best recall (mean±std) | random best p95_ms (mean±std) |
| --- | ---: | ---: | ---: | ---: |
| 1 | 0.8402±0.2143 | 0.2063±0.1600 | 0.8402±0.2143 | 0.1990±0.1901 |
| 2 | 0.9237±0.0898 | 0.1931±0.1535 | 0.9237±0.0898 | 0.1919±0.1810 |
| 3 | 0.9215±0.0739 | 0.1352±0.0619 | 0.9215±0.0739 | 0.1499±0.0521 |
| 4 | 0.9383±0.0583 | 0.1373±0.0594 | 0.9383±0.0583 | 0.1509±0.0501 |
| 5 | 0.9700±0.0344 | 0.1987±0.1096 | 0.9700±0.0344 | 0.1920±0.0749 |
| 6 | 0.9722±0.0308 | 0.2053±0.1019 | 0.9722±0.0308 | 0.1928±0.0739 |
| 7 | 0.9867±0.0180 | 0.2271±0.0863 | 0.9867±0.0180 | 0.2201±0.0612 |
| 8 | 0.9853±0.0175 | 0.2211±0.0918 | 0.9853±0.0175 | 0.2044±0.0761 |
| 9 | 0.9873±0.0135 | 0.2066±0.1058 | 0.9873±0.0135 | 0.1864±0.0878 |
| 10 | 0.9877±0.0138 | 0.1740±0.0589 | 0.9877±0.0138 | 0.1683±0.0621 |
| 11 | 0.9877±0.0138 | 0.1740±0.0589 | 0.9877±0.0138 | 0.1683±0.0621 |
| 12 | 0.9885±0.0142 | 0.1727±0.0577 | 0.9877±0.0138 | 0.1683±0.0621 |
| 13 | 0.9887±0.0143 | 0.1697±0.0554 | 0.9877±0.0138 | 0.1683±0.0621 |
| 14 | 0.9787±0.0195 | 0.1530±0.0476 | 0.9877±0.0138 | 0.1683±0.0621 |
| 15 | 0.9787±0.0195 | 0.1530±0.0476 | 0.9877±0.0138 | 0.1683±0.0621 |
| 16 | 0.9787±0.0195 | 0.1530±0.0476 | 0.9777±0.0185 | 0.1427±0.0540 |
| 17 | 0.9787±0.0195 | 0.1530±0.0476 | 0.9777±0.0185 | 0.1427±0.0540 |
| 18 | 0.9782±0.0190 | 0.1472±0.0420 | 0.9718±0.0172 | 0.1299±0.0571 |
| 19 | 0.9743±0.0168 | 0.1316±0.0418 | 0.9718±0.0172 | 0.1299±0.0571 |
| 20 | 0.9718±0.0145 | 0.1159±0.0217 | 0.9693±0.0145 | 0.1035±0.0082 |
| 21 | 0.9718±0.0145 | 0.1083±0.0237 | 0.9693±0.0145 | 0.0977±0.0105 |
| 22 | 0.9718±0.0145 | 0.1083±0.0237 | 0.9693±0.0145 | 0.0977±0.0105 |
| 23 | 0.9693±0.0120 | 0.1068±0.0226 | 0.9693±0.0145 | 0.0977±0.0105 |
| 24 | 0.9682±0.0114 | 0.1034±0.0216 | 0.9657±0.0106 | 0.0948±0.0092 |
| 25 | 0.9682±0.0114 | 0.1034±0.0216 | 0.9657±0.0106 | 0.0948±0.0092 |
| 26 | 0.9682±0.0114 | 0.1034±0.0216 | 0.9657±0.0106 | 0.0948±0.0092 |
| 27 | 0.9732±0.0070 | 0.1028±0.0204 | 0.9657±0.0106 | 0.0948±0.0092 |
| 28 | 0.9732±0.0070 | 0.1028±0.0204 | 0.9657±0.0106 | 0.0948±0.0092 |
| 29 | 0.9767±0.0093 | 0.1010±0.0207 | 0.9657±0.0106 | 0.0948±0.0092 |
| 30 | 0.9767±0.0093 | 0.1010±0.0207 | 0.9657±0.0106 | 0.0948±0.0092 |

### backend: faiss-ivf

| trial | optuna best recall (mean±std) | optuna best p95_ms (mean±std) | random best recall (mean±std) | random best p95_ms (mean±std) |
| --- | ---: | ---: | ---: | ---: |
| 1 | 0.5877±0.2126 | 0.0599±0.0146 | 0.5877±0.2126 | 0.0596±0.0515 |
| 2 | 0.7645±0.1857 | 0.0902±0.0869 | 0.7645±0.1857 | 0.0905±0.0687 |
| 3 | 0.8017±0.1610 | 0.1165±0.0910 | 0.8017±0.1610 | 0.1465±0.0938 |
| 4 | 0.9132±0.1650 | 0.1132±0.0843 | 0.9082±0.1626 | 0.2095±0.1239 |
| 5 | 0.9597±0.0750 | 0.1055±0.0831 | 0.9547±0.0729 | 0.7215±1.0097 |
| 6 | 0.9597±0.0750 | 0.1055±0.0831 | 0.9547±0.0729 | 0.7215±1.0097 |
| 7 | 0.9597±0.0750 | 0.1055±0.0831 | 0.9547±0.0729 | 0.7215±1.0097 |
| 8 | 0.9555±0.0732 | 0.1041±0.0842 | 0.9547±0.0729 | 0.7215±1.0097 |
| 9 | 0.9515±0.0718 | 0.0965±0.0838 | 0.9507±0.0715 | 0.6539±1.0428 |
| 10 | 0.9895±0.0133 | 0.0492±0.0205 | 0.9887±0.0140 | 0.1222±0.0637 |
| 11 | 0.9895±0.0133 | 0.0492±0.0205 | 0.9887±0.0140 | 0.1222±0.0637 |
| 12 | 0.9933±0.0125 | 0.0439±0.0225 | 0.9838±0.0135 | 0.1209±0.0650 |
| 13 | 0.9933±0.0125 | 0.0439±0.0225 | 0.9838±0.0135 | 0.1209±0.0650 |
| 14 | 0.9950±0.0092 | 0.0302±0.0105 | 0.9742±0.0156 | 0.1026±0.0493 |
| 15 | 0.9950±0.0092 | 0.0302±0.0105 | 0.9713±0.0164 | 0.0796±0.0446 |
| 16 | 0.9950±0.0092 | 0.0302±0.0105 | 0.9713±0.0164 | 0.0796±0.0446 |
| 17 | 0.9950±0.0092 | 0.0302±0.0105 | 0.9713±0.0164 | 0.0796±0.0446 |
| 18 | 0.9950±0.0092 | 0.0302±0.0105 | 0.9713±0.0164 | 0.0796±0.0446 |
| 19 | 0.9933±0.0089 | 0.0282±0.0089 | 0.9685±0.0139 | 0.0692±0.0342 |
| 20 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9747±0.0159 | 0.0643±0.0391 |
| 21 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9827±0.0118 | 0.0599±0.0340 |
| 22 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9827±0.0118 | 0.0599±0.0340 |
| 23 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9747±0.0159 | 0.0532±0.0298 |
| 24 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9748±0.0159 | 0.0509±0.0302 |
| 25 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9748±0.0159 | 0.0509±0.0302 |
| 26 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9748±0.0159 | 0.0509±0.0302 |
| 27 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9748±0.0159 | 0.0509±0.0302 |
| 28 | 0.9872±0.0147 | 0.0262±0.0092 | 0.9748±0.0159 | 0.0509±0.0302 |
| 29 | 0.9860±0.0139 | 0.0255±0.0079 | 0.9717±0.0167 | 0.0481±0.0317 |
| 30 | 0.9807±0.0202 | 0.0252±0.0081 | 0.9735±0.0148 | 0.0467±0.0313 |

### backend: hnswlib

| trial | optuna best recall (mean±std) | optuna best p95_ms (mean±std) | random best recall (mean±std) | random best p95_ms (mean±std) |
| --- | ---: | ---: | ---: | ---: |
| 1 | 0.8722±0.1323 | 0.0756±0.0517 | 0.8717±0.1315 | 0.0435±0.0286 |
| 2 | 0.9600±0.0496 | 0.1483±0.0885 | 0.9595±0.0515 | 0.1262±0.1038 |
| 3 | 0.9922±0.0079 | 0.0862±0.0530 | 0.9925±0.0072 | 0.0859±0.0596 |
| 4 | 0.9922±0.0079 | 0.0862±0.0530 | 0.9947±0.0048 | 0.0838±0.0610 |
| 5 | 0.9923±0.0079 | 0.0745±0.0456 | 0.9947±0.0048 | 0.0838±0.0610 |
| 6 | 0.9923±0.0079 | 0.0607±0.0236 | 0.9947±0.0048 | 0.0694±0.0344 |
| 7 | 0.9923±0.0079 | 0.0607±0.0236 | 0.9947±0.0048 | 0.0694±0.0344 |
| 8 | 0.9923±0.0063 | 0.0547±0.0198 | 0.9918±0.0066 | 0.0567±0.0198 |
| 9 | 0.9922±0.0062 | 0.0517±0.0200 | 0.9875±0.0091 | 0.0446±0.0114 |
| 10 | 0.9922±0.0062 | 0.0517±0.0200 | 0.9875±0.0091 | 0.0446±0.0114 |
| 11 | 0.9852±0.0135 | 0.0442±0.0128 | 0.9875±0.0091 | 0.0446±0.0114 |
| 12 | 0.9887±0.0078 | 0.0424±0.0132 | 0.9875±0.0091 | 0.0446±0.0114 |
| 13 | 0.9887±0.0078 | 0.0424±0.0132 | 0.9883±0.0080 | 0.0426±0.0118 |
| 14 | 0.9840±0.0126 | 0.0407±0.0147 | 0.9883±0.0080 | 0.0426±0.0118 |
| 15 | 0.9840±0.0126 | 0.0407±0.0147 | 0.9883±0.0080 | 0.0426±0.0118 |
| 16 | 0.9840±0.0126 | 0.0407±0.0147 | 0.9883±0.0080 | 0.0426±0.0118 |
| 17 | 0.9840±0.0126 | 0.0407±0.0147 | 0.9883±0.0080 | 0.0426±0.0118 |
| 18 | 0.9840±0.0126 | 0.0407±0.0147 | 0.9883±0.0080 | 0.0426±0.0118 |
| 19 | 0.9835±0.0121 | 0.0394±0.0124 | 0.9883±0.0080 | 0.0426±0.0118 |
| 20 | 0.9835±0.0121 | 0.0394±0.0124 | 0.9883±0.0080 | 0.0426±0.0118 |
| 21 | 0.9813±0.0103 | 0.0360±0.0074 | 0.9747±0.0148 | 0.0351±0.0072 |
| 22 | 0.9763±0.0079 | 0.0331±0.0064 | 0.9697±0.0103 | 0.0313±0.0052 |
| 23 | 0.9738±0.0122 | 0.0329±0.0067 | 0.9697±0.0103 | 0.0313±0.0052 |
| 24 | 0.9748±0.0133 | 0.0319±0.0053 | 0.9697±0.0103 | 0.0313±0.0052 |
| 25 | 0.9748±0.0133 | 0.0319±0.0053 | 0.9697±0.0103 | 0.0313±0.0052 |
| 26 | 0.9748±0.0133 | 0.0319±0.0053 | 0.9697±0.0103 | 0.0313±0.0052 |
| 27 | 0.9748±0.0133 | 0.0319±0.0053 | 0.9697±0.0103 | 0.0313±0.0052 |
| 28 | 0.9748±0.0133 | 0.0319±0.0053 | 0.9697±0.0103 | 0.0313±0.0052 |
| 29 | 0.9687±0.0109 | 0.0291±0.0033 | 0.9693±0.0103 | 0.0313±0.0052 |
| 30 | 0.9688±0.0111 | 0.0289±0.0030 | 0.9693±0.0103 | 0.0313±0.0052 |

## 3. Distribution (final best across seeds)

| backend | method | recall mean±std | recall 95% CI | p95_ms mean±std | p95_ms 95% CI | build_s mean±std |
| --- | --- | ---: | ---: | ---: | ---: | ---: |
| annoy | baseline-fixed | 0.9900 | [0.9900, 0.9900] | 0.1642 | [0.1642, 0.1642] | 0.0363 |
| annoy | random-search | 0.9657±0.0106 | [0.9564, 0.9750] | 0.0948±0.0092 | [0.0868, 0.1029] | 0.0313±0.0182 |
| annoy | optuna | 0.9767±0.0093 | [0.9685, 0.9848] | 0.1010±0.0207 | [0.0828, 0.1191] | 0.0326±0.0299 |
| faiss-ivf | baseline-fixed | 0.6908 | [0.6908, 0.6908] | 0.0329 | [0.0329, 0.0329] | 0.0027 |
| faiss-ivf | random-search | 0.9735±0.0148 | [0.9605, 0.9865] | 0.0467±0.0313 | [0.0193, 0.0742] | 0.0164±0.0274 |
| faiss-ivf | optuna | 0.9807±0.0202 | [0.9630, 0.9984] | 0.0252±0.0081 | [0.0181, 0.0323] | 0.0038±0.0023 |
| hnswlib | baseline-fixed | 0.9983 | [0.9983, 0.9983] | 0.0797 | [0.0797, 0.0797] | 0.0283 |
| hnswlib | random-search | 0.9693±0.0103 | [0.9603, 0.9784] | 0.0313±0.0052 | [0.0267, 0.0358] | 0.0612±0.0215 |
| hnswlib | optuna | 0.9688±0.0111 | [0.9591, 0.9785] | 0.0289±0.0030 | [0.0263, 0.0315] | 0.0370±0.0130 |

## 4. Win-rate (Optuna vs Random, same budget)

| backend | wins | ties | losses | win_rate |
| --- | ---: | ---: | ---: | ---: |
| annoy | 4 | 0 | 1 | 80.0% |
| faiss-ivf | 2 | 0 | 3 | 40.0% |
| hnswlib | 2 | 0 | 3 | 40.0% |
